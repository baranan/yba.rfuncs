<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Annotation Example</title>
	<link rel="stylesheet" href="https://baranan.github.io/yba.rfuncs/annotation.css">
</head>
<body>
	<div id="drop-area">
		<h1>Drag and drop a file here</h1>
		<p>Or click to select a file to annotate</p>
		<input type="file" id="file-input">
	</div>

	<button id="add-annotation-button">Add Annotation</button>
	<button id="save-annotations-button">Save annotated file</button>

	<script src="https://baranan.github.io/yba.rfuncs/annotation.js"></script>
	<script>
		// Get references to the drop area and file input
		const dropArea = document.querySelector('#drop-area');
		
		  // Add event listeners for drag and drop events
		  dropArea.addEventListener('dragenter', handleDragEnter);
		  dropArea.addEventListener('dragover', handleDragOver);
		  dropArea.addEventListener('dragleave', handleDragLeave);
		  dropArea.addEventListener('drop', handleDrop);

		  // Define the event handlers
		  function handleDragEnter(e) {
		    // Prevent default behavior to allow drop
		    e.preventDefault();
		    // Add a class to highlight the drop area
		    dropArea.classList.add('highlight');
		  }

		  function handleDragOver(e) {
		    // Prevent default behavior to allow drop
		    e.preventDefault();
		    // Add a class to highlight the drop area
		    dropArea.classList.add('highlight');
		  }

		  function handleDragLeave(e) {
		    // Remove the class that highlights the drop area
		    dropArea.classList.remove('highlight');
		  }

		
		const fileInput = document.querySelector('#file-input');
		// Listen for the change event on the file input
		fileInput.addEventListener('change', handleFileSelect);

		function handleDrop(event) {
			event.preventDefault();
			event.stopPropagation();

			const files = event.dataTransfer.files;

			if (files.length > 0) {
				handleFile(files[0]);
			}
		}

		function handleFileSelect(event) {
			const files = event.target.files;

			if (files.length > 0) {
				handleFile(files[0]);
			}
		}

		function handleFile(file) {
			// Read the contents of the file
			const reader = new FileReader();

			reader.onload = function(event) {
				const contents = event.target.result;

				// Append the file contents to the HTML
				const pre = document.createElement('pre');
				pre.innerText = contents;
				document.body.appendChild(pre);

				// Add the annotation CSS and JS includes
				const css = document.createElement('link');
				css.rel = 'stylesheet';
				css.href = 'https://baranan.github.io/yba.rfuncs/annotation.css';
				document.head.appendChild(css);

				const script = document.createElement('script');
				script.src = 'https://baranan.github.io/yba.rfuncs/annotation.js';
				document.body.appendChild(script);
			}

			reader.readAsText(file);
		}
	</script>
</body>
</html>
